(function (factory) {
    if (typeof module === 'object' && typeof module.exports === 'object') {
        var v = factory(require, exports); if (v !== undefined) module.exports = v;
    }
    else if (typeof define === 'function' && define.amd) {
        define(["require", "exports", './has'], factory);
    }
})(function (require, exports) {
    "use strict";
    var has_1 = require('./has');
    var FRACTION_UNITS = Math.pow(2, 23);
    var MAX_FLOAT32 = 3.4028234663852886e+38;
    var MIN_FLOAT32 = 1.401298464324817e-45;
    /**
     * Returns the hyperbolic arccosine of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function acosh(n) {
        return Math.log(n + Math.sqrt(n * n - 1));
    }
    exports.acosh = acosh;
    /**
     * Returns the hyperbolic arcsine of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function asinh(n) {
        if (n === -Infinity) {
            return n;
        }
        else {
            return Math.log(n + Math.sqrt(n * n + 1));
        }
    }
    exports.asinh = asinh;
    /**
     * Returns the hyperbolic arctangent of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function atanh(n) {
        return Math.log((1 + n) / (1 - n)) / 2;
    }
    exports.atanh = atanh;
    /**
     * Returns the cube root of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function cbrt(n) {
        var y = Math.pow(Math.abs(n), 1 / 3);
        return n < 0 ? -y : y;
    }
    exports.cbrt = cbrt;
    /**
     * Returns the number of leading zero bits in the 32-bit
     * binary representation of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function clz32(n) {
        n = Number(n) >>> 0;
        return n ? 32 - n.toString(2).length : 32;
    }
    exports.clz32 = clz32;
    /**
     * Returns the hyperbolic cosine of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function cosh(n) {
        var m = Math.exp(n);
        return (m + 1 / m) / 2;
    }
    exports.cosh = cosh;
    /**
     * Returns e raised to the specified power minus one.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function expm1(n) {
        return Math.exp(n) - 1;
    }
    exports.expm1 = expm1;
    /**
     * Returns the nearest single-precision float representation of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    exports.fround = has_1.default('float32array') ? function (n) {
        return new Float32Array([n])[0];
    } :
        function (n) {
            // Further fallback for IE9, which doesn't support Float32Array.
            // This gives a fair approximation in most cases.
            if (n === 0 || !isFinite(n)) {
                return n;
            }
            if (Math.abs(n) > MAX_FLOAT32) {
                return n > 0 ? Infinity : -Infinity;
            }
            if (Math.abs(n) < MIN_FLOAT32) {
                return 0;
            }
            var exponent = Math.floor(log2(Math.abs(n)));
            return (Math.round((n / Math.pow(2, exponent) - 1) * FRACTION_UNITS) / FRACTION_UNITS + 1) * Math.pow(2, exponent);
        };
    /**
     * Returns the square root of the sum of squares of its arguments.
     *
     * @return The result
     */
    function hypot() {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i - 0] = arguments[_i];
        }
        // See: http://mzl.la/1HDi6xP
        var n = 0;
        for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {
            var arg = args_1[_a];
            if (arg === Infinity || arg === -Infinity) {
                return Infinity;
            }
            n += arg * arg;
        }
        return Math.sqrt(n);
    }
    exports.hypot = hypot;
    /**
     * Returns the result of the 32-bit multiplication of the two parameters.
     *
     * @param n The number to use in calculation
     * @param m The number to use in calculation
     * @return The result
     */
    function imul(n, m) {
        // See: http://mzl.la/1K279FK
        var ah = (n >>> 16) & 0xffff;
        var al = n & 0xffff;
        var bh = (m >>> 16) & 0xffff;
        var bl = m & 0xffff;
        return ((al * bl) + (((ah * bl + al * bh) << 16) >>> 0) | 0);
    }
    exports.imul = imul;
    /**
     * Returns the base 2 logarithm of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function log2(n) {
        return Math.log(n) / Math.LN2;
    }
    exports.log2 = log2;
    /**
     * Returns the base 10 logarithm of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function log10(n) {
        return Math.log(n) / Math.LN10;
    }
    exports.log10 = log10;
    /**
     * Returns the natural logarithm of 1 + a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function log1p(n) {
        return Math.log(1 + n);
    }
    exports.log1p = log1p;
    /**
     * Returns the sign of a number, indicating whether the number is positive.
     *
     * @param n The number to use in calculation
     * @return 1 if the number is positive, -1 if the number is negative, or 0 if the number is 0
     */
    function sign(n) {
        n = Number(n);
        if (n === 0 || n !== n) {
            return n;
        }
        return n > 0 ? 1 : -1;
    }
    exports.sign = sign;
    /**
     * Returns the hyperbolic sine of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function sinh(n) {
        var m = Math.exp(n);
        return (m - 1 / m) / 2;
    }
    exports.sinh = sinh;
    /**
     * Returns the hyperbolic tangent of a number.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function tanh(n) {
        if (n === Infinity) {
            return 1;
        }
        else if (n === -Infinity) {
            return -1;
        }
        else {
            var y = Math.exp(2 * n);
            return (y - 1) / (y + 1);
        }
    }
    exports.tanh = tanh;
    /**
     * Returns the integral part of a number by removing any fractional digits.
     *
     * @param n The number to use in calculation
     * @return The result
     */
    function trunc(n) {
        return n < 0 ? Math.ceil(n) : Math.floor(n);
    }
    exports.trunc = trunc;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0aC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9tYXRoLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztJQUFBLG9CQUFnQixPQUFPLENBQUMsQ0FBQTtJQUV4QixJQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN2QyxJQUFNLFdBQVcsR0FBRyxzQkFBc0IsQ0FBQztJQUMzQyxJQUFNLFdBQVcsR0FBRyxxQkFBcUIsQ0FBQztJQUUxQzs7Ozs7T0FLRztJQUNILGVBQXNCLENBQVM7UUFDOUIsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzNDLENBQUM7SUFGZSxhQUFLLFFBRXBCLENBQUE7SUFFRDs7Ozs7T0FLRztJQUNILGVBQXNCLENBQVM7UUFDOUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztZQUNyQixNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ1YsQ0FBQztRQUNELElBQUksQ0FBQyxDQUFDO1lBQ0wsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzNDLENBQUM7SUFDRixDQUFDO0lBUGUsYUFBSyxRQU9wQixDQUFBO0lBRUQ7Ozs7O09BS0c7SUFDSCxlQUFzQixDQUFTO1FBQzlCLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFGZSxhQUFLLFFBRXBCLENBQUE7SUFFRDs7Ozs7T0FLRztJQUNILGNBQXFCLENBQVM7UUFDN0IsSUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN2QyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdkIsQ0FBQztJQUhlLFlBQUksT0FHbkIsQ0FBQTtJQUVEOzs7Ozs7T0FNRztJQUNILGVBQXNCLENBQVM7UUFDOUIsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDcEIsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO0lBQzNDLENBQUM7SUFIZSxhQUFLLFFBR3BCLENBQUE7SUFFRDs7Ozs7T0FLRztJQUNILGNBQXFCLENBQVM7UUFDN0IsSUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0QixNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN4QixDQUFDO0lBSGUsWUFBSSxPQUduQixDQUFBO0lBRUQ7Ozs7O09BS0c7SUFDSCxlQUFzQixDQUFTO1FBQzlCLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN4QixDQUFDO0lBRmUsYUFBSyxRQUVwQixDQUFBO0lBRUQ7Ozs7O09BS0c7SUFDVSxjQUFNLEdBQTBCLGFBQUcsQ0FBQyxjQUFjLENBQUMsR0FBRyxVQUFVLENBQVM7UUFDckYsTUFBTSxDQUFDLElBQUksWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNqQyxDQUFDO1FBQ0QsVUFBVSxDQUFTO1lBQ2xCLGdFQUFnRTtZQUNoRSxpREFBaUQ7WUFFakQsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzdCLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDVixDQUFDO1lBQ0QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxXQUFXLENBQUMsQ0FBQyxDQUFDO2dCQUMvQixNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxRQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUM7WUFDckMsQ0FBQztZQUNELEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQztnQkFDL0IsTUFBTSxDQUFDLENBQUMsQ0FBQztZQUNWLENBQUM7WUFDRCxJQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMvQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLGNBQWMsQ0FBQyxHQUFHLGNBQWMsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNwSCxDQUFDLENBQUM7SUFFRjs7OztPQUlHO0lBQ0g7UUFBc0IsY0FBaUI7YUFBakIsV0FBaUIsQ0FBakIsc0JBQWlCLENBQWpCLElBQWlCO1lBQWpCLDZCQUFpQjs7UUFDdEMsNkJBQTZCO1FBQzdCLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUVWLEdBQUcsQ0FBQyxDQUFZLFVBQUksRUFBSixhQUFJLEVBQUosa0JBQUksRUFBSixJQUFJLENBQUM7WUFBaEIsSUFBSSxHQUFHLGFBQUE7WUFDWCxFQUFFLENBQUMsQ0FBQyxHQUFHLEtBQUssUUFBUSxJQUFJLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7Z0JBQzNDLE1BQU0sQ0FBQyxRQUFRLENBQUM7WUFDakIsQ0FBQztZQUNELENBQUMsSUFBSSxHQUFHLEdBQUcsR0FBRyxDQUFDO1NBQ2Y7UUFDRCxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNyQixDQUFDO0lBWGUsYUFBSyxRQVdwQixDQUFBO0lBRUQ7Ozs7OztPQU1HO0lBQ0gsY0FBcUIsQ0FBUyxFQUFFLENBQVM7UUFDeEMsNkJBQTZCO1FBQzdCLElBQU0sRUFBRSxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQztRQUMvQixJQUFNLEVBQUUsR0FBRyxDQUFDLEdBQUcsTUFBTSxDQUFDO1FBQ3RCLElBQU0sRUFBRSxHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQztRQUMvQixJQUFNLEVBQUUsR0FBRyxDQUFDLEdBQUcsTUFBTSxDQUFDO1FBQ3RCLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQzlELENBQUM7SUFQZSxZQUFJLE9BT25CLENBQUE7SUFFRDs7Ozs7T0FLRztJQUNILGNBQXFCLENBQVM7UUFDN0IsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQztJQUMvQixDQUFDO0lBRmUsWUFBSSxPQUVuQixDQUFBO0lBRUQ7Ozs7O09BS0c7SUFDSCxlQUFzQixDQUFTO1FBQzlCLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDaEMsQ0FBQztJQUZlLGFBQUssUUFFcEIsQ0FBQTtJQUVEOzs7OztPQUtHO0lBQ0gsZUFBc0IsQ0FBUztRQUM5QixNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDeEIsQ0FBQztJQUZlLGFBQUssUUFFcEIsQ0FBQTtJQUVEOzs7OztPQUtHO0lBQ0gsY0FBcUIsQ0FBUztRQUM3QixDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2QsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN4QixNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ1YsQ0FBQztRQUNELE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUN2QixDQUFDO0lBTmUsWUFBSSxPQU1uQixDQUFBO0lBRUQ7Ozs7O09BS0c7SUFDSCxjQUFxQixDQUFTO1FBQzdCLElBQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEIsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDeEIsQ0FBQztJQUhlLFlBQUksT0FHbkIsQ0FBQTtJQUVEOzs7OztPQUtHO0lBQ0gsY0FBcUIsQ0FBUztRQUM3QixFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQztZQUNwQixNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ1YsQ0FBQztRQUNELElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQzFCLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNYLENBQUM7UUFDRCxJQUFJLENBQUMsQ0FBQztZQUNMLElBQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQzFCLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMxQixDQUFDO0lBQ0YsQ0FBQztJQVhlLFlBQUksT0FXbkIsQ0FBQTtJQUVEOzs7OztPQUtHO0lBQ0gsZUFBc0IsQ0FBUztRQUM5QixNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUZlLGFBQUssUUFFcEIsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBoYXMgZnJvbSAnLi9oYXMnO1xuXG5jb25zdCBGUkFDVElPTl9VTklUUyA9IE1hdGgucG93KDIsIDIzKTtcbmNvbnN0IE1BWF9GTE9BVDMyID0gMy40MDI4MjM0NjYzODUyODg2ZSszODtcbmNvbnN0IE1JTl9GTE9BVDMyID0gMS40MDEyOTg0NjQzMjQ4MTdlLTQ1O1xuXG4vKipcbiAqIFJldHVybnMgdGhlIGh5cGVyYm9saWMgYXJjY29zaW5lIG9mIGEgbnVtYmVyLlxuICpcbiAqIEBwYXJhbSBuIFRoZSBudW1iZXIgdG8gdXNlIGluIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJuIFRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFjb3NoKG46IG51bWJlcik6IG51bWJlciB7XG5cdHJldHVybiBNYXRoLmxvZyhuICsgTWF0aC5zcXJ0KG4gKiBuIC0gMSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGh5cGVyYm9saWMgYXJjc2luZSBvZiBhIG51bWJlci5cbiAqXG4gKiBAcGFyYW0gbiBUaGUgbnVtYmVyIHRvIHVzZSBpbiBjYWxjdWxhdGlvblxuICogQHJldHVybiBUaGUgcmVzdWx0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhc2luaChuOiBudW1iZXIpOiBudW1iZXIge1xuXHRpZiAobiA9PT0gLUluZmluaXR5KSB7XG5cdFx0cmV0dXJuIG47XG5cdH1cblx0ZWxzZSB7XG5cdFx0cmV0dXJuIE1hdGgubG9nKG4gKyBNYXRoLnNxcnQobiAqIG4gKyAxKSk7XG5cdH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBoeXBlcmJvbGljIGFyY3RhbmdlbnQgb2YgYSBudW1iZXIuXG4gKlxuICogQHBhcmFtIG4gVGhlIG51bWJlciB0byB1c2UgaW4gY2FsY3VsYXRpb25cbiAqIEByZXR1cm4gVGhlIHJlc3VsdFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXRhbmgobjogbnVtYmVyKTogbnVtYmVyIHtcblx0cmV0dXJuIE1hdGgubG9nKCgxICsgbikgLyAoMSAtIG4pKSAvIDI7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgY3ViZSByb290IG9mIGEgbnVtYmVyLlxuICpcbiAqIEBwYXJhbSBuIFRoZSBudW1iZXIgdG8gdXNlIGluIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJuIFRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNicnQobjogbnVtYmVyKTogbnVtYmVyIHtcblx0Y29uc3QgeSA9IE1hdGgucG93KE1hdGguYWJzKG4pLCAxIC8gMyk7XG5cdHJldHVybiBuIDwgMCA/IC15IDogeTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgbGVhZGluZyB6ZXJvIGJpdHMgaW4gdGhlIDMyLWJpdFxuICogYmluYXJ5IHJlcHJlc2VudGF0aW9uIG9mIGEgbnVtYmVyLlxuICpcbiAqIEBwYXJhbSBuIFRoZSBudW1iZXIgdG8gdXNlIGluIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJuIFRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNsejMyKG46IG51bWJlcik6IG51bWJlciB7XG5cdG4gPSBOdW1iZXIobikgPj4+IDA7XG5cdHJldHVybiBuID8gMzIgLSBuLnRvU3RyaW5nKDIpLmxlbmd0aCA6IDMyO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGh5cGVyYm9saWMgY29zaW5lIG9mIGEgbnVtYmVyLlxuICpcbiAqIEBwYXJhbSBuIFRoZSBudW1iZXIgdG8gdXNlIGluIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJuIFRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvc2gobjogbnVtYmVyKTogbnVtYmVyIHtcblx0Y29uc3QgbSA9IE1hdGguZXhwKG4pO1xuXHRyZXR1cm4gKG0gKyAxIC8gbSkgLyAyO1xufVxuXG4vKipcbiAqIFJldHVybnMgZSByYWlzZWQgdG8gdGhlIHNwZWNpZmllZCBwb3dlciBtaW51cyBvbmUuXG4gKlxuICogQHBhcmFtIG4gVGhlIG51bWJlciB0byB1c2UgaW4gY2FsY3VsYXRpb25cbiAqIEByZXR1cm4gVGhlIHJlc3VsdFxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwbTEobjogbnVtYmVyKTogbnVtYmVyIHtcblx0cmV0dXJuIE1hdGguZXhwKG4pIC0gMTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBuZWFyZXN0IHNpbmdsZS1wcmVjaXNpb24gZmxvYXQgcmVwcmVzZW50YXRpb24gb2YgYSBudW1iZXIuXG4gKlxuICogQHBhcmFtIG4gVGhlIG51bWJlciB0byB1c2UgaW4gY2FsY3VsYXRpb25cbiAqIEByZXR1cm4gVGhlIHJlc3VsdFxuICovXG5leHBvcnQgY29uc3QgZnJvdW5kOiAobjogbnVtYmVyKSA9PiBudW1iZXIgPSBoYXMoJ2Zsb2F0MzJhcnJheScpID8gZnVuY3Rpb24gKG46IG51bWJlcik6IG51bWJlciB7XG5cdHJldHVybiBuZXcgRmxvYXQzMkFycmF5KFtuXSlbMF07XG59IDpcbmZ1bmN0aW9uIChuOiBudW1iZXIpOiBudW1iZXIge1xuXHQvLyBGdXJ0aGVyIGZhbGxiYWNrIGZvciBJRTksIHdoaWNoIGRvZXNuJ3Qgc3VwcG9ydCBGbG9hdDMyQXJyYXkuXG5cdC8vIFRoaXMgZ2l2ZXMgYSBmYWlyIGFwcHJveGltYXRpb24gaW4gbW9zdCBjYXNlcy5cblxuXHRpZiAobiA9PT0gMCB8fCAhaXNGaW5pdGUobikpIHtcblx0XHRyZXR1cm4gbjtcblx0fVxuXHRpZiAoTWF0aC5hYnMobikgPiBNQVhfRkxPQVQzMikge1xuXHRcdHJldHVybiBuID4gMCA/IEluZmluaXR5IDogLUluZmluaXR5O1xuXHR9XG5cdGlmIChNYXRoLmFicyhuKSA8IE1JTl9GTE9BVDMyKSB7XG5cdFx0cmV0dXJuIDA7XG5cdH1cblx0Y29uc3QgZXhwb25lbnQgPSBNYXRoLmZsb29yKGxvZzIoTWF0aC5hYnMobikpKTtcblx0cmV0dXJuIChNYXRoLnJvdW5kKChuIC8gTWF0aC5wb3coMiwgZXhwb25lbnQpIC0gMSkgKiBGUkFDVElPTl9VTklUUykgLyBGUkFDVElPTl9VTklUUyArIDEpICogTWF0aC5wb3coMiwgZXhwb25lbnQpO1xufTtcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzcXVhcmUgcm9vdCBvZiB0aGUgc3VtIG9mIHNxdWFyZXMgb2YgaXRzIGFyZ3VtZW50cy5cbiAqXG4gKiBAcmV0dXJuIFRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGh5cG90KC4uLmFyZ3M6IG51bWJlcltdKTogbnVtYmVyIHtcblx0Ly8gU2VlOiBodHRwOi8vbXpsLmxhLzFIRGk2eFBcblx0bGV0IG4gPSAwO1xuXG5cdGZvciAobGV0IGFyZyBvZiBhcmdzKSB7XG5cdFx0aWYgKGFyZyA9PT0gSW5maW5pdHkgfHwgYXJnID09PSAtSW5maW5pdHkpIHtcblx0XHRcdHJldHVybiBJbmZpbml0eTtcblx0XHR9XG5cdFx0biArPSBhcmcgKiBhcmc7XG5cdH1cblx0cmV0dXJuIE1hdGguc3FydChuKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSByZXN1bHQgb2YgdGhlIDMyLWJpdCBtdWx0aXBsaWNhdGlvbiBvZiB0aGUgdHdvIHBhcmFtZXRlcnMuXG4gKlxuICogQHBhcmFtIG4gVGhlIG51bWJlciB0byB1c2UgaW4gY2FsY3VsYXRpb25cbiAqIEBwYXJhbSBtIFRoZSBudW1iZXIgdG8gdXNlIGluIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJuIFRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGltdWwobjogbnVtYmVyLCBtOiBudW1iZXIpOiBudW1iZXIge1xuXHQvLyBTZWU6IGh0dHA6Ly9temwubGEvMUsyNzlGS1xuXHRjb25zdCBhaCA9IChuID4+PiAxNikgJiAweGZmZmY7XG5cdGNvbnN0IGFsID0gbiAmIDB4ZmZmZjtcblx0Y29uc3QgYmggPSAobSA+Pj4gMTYpICYgMHhmZmZmO1xuXHRjb25zdCBibCA9IG0gJiAweGZmZmY7XG5cdHJldHVybiAoKGFsICogYmwpICsgKCgoYWggKiBibCArIGFsICogYmgpIDw8IDE2KSA+Pj4gMCkgfCAwKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBiYXNlIDIgbG9nYXJpdGhtIG9mIGEgbnVtYmVyLlxuICpcbiAqIEBwYXJhbSBuIFRoZSBudW1iZXIgdG8gdXNlIGluIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJuIFRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZzIobjogbnVtYmVyKTogbnVtYmVyIHtcblx0cmV0dXJuIE1hdGgubG9nKG4pIC8gTWF0aC5MTjI7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgYmFzZSAxMCBsb2dhcml0aG0gb2YgYSBudW1iZXIuXG4gKlxuICogQHBhcmFtIG4gVGhlIG51bWJlciB0byB1c2UgaW4gY2FsY3VsYXRpb25cbiAqIEByZXR1cm4gVGhlIHJlc3VsdFxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9nMTAobjogbnVtYmVyKTogbnVtYmVyIHtcblx0cmV0dXJuIE1hdGgubG9nKG4pIC8gTWF0aC5MTjEwO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIG5hdHVyYWwgbG9nYXJpdGhtIG9mIDEgKyBhIG51bWJlci5cbiAqXG4gKiBAcGFyYW0gbiBUaGUgbnVtYmVyIHRvIHVzZSBpbiBjYWxjdWxhdGlvblxuICogQHJldHVybiBUaGUgcmVzdWx0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2cxcChuOiBudW1iZXIpOiBudW1iZXIge1xuXHRyZXR1cm4gTWF0aC5sb2coMSArIG4pO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHNpZ24gb2YgYSBudW1iZXIsIGluZGljYXRpbmcgd2hldGhlciB0aGUgbnVtYmVyIGlzIHBvc2l0aXZlLlxuICpcbiAqIEBwYXJhbSBuIFRoZSBudW1iZXIgdG8gdXNlIGluIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJuIDEgaWYgdGhlIG51bWJlciBpcyBwb3NpdGl2ZSwgLTEgaWYgdGhlIG51bWJlciBpcyBuZWdhdGl2ZSwgb3IgMCBpZiB0aGUgbnVtYmVyIGlzIDBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNpZ24objogbnVtYmVyKTogbnVtYmVyIHtcblx0biA9IE51bWJlcihuKTtcblx0aWYgKG4gPT09IDAgfHwgbiAhPT0gbikge1xuXHRcdHJldHVybiBuO1xuXHR9XG5cdHJldHVybiBuID4gMCA/IDEgOiAtMTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBoeXBlcmJvbGljIHNpbmUgb2YgYSBudW1iZXIuXG4gKlxuICogQHBhcmFtIG4gVGhlIG51bWJlciB0byB1c2UgaW4gY2FsY3VsYXRpb25cbiAqIEByZXR1cm4gVGhlIHJlc3VsdFxuICovXG5leHBvcnQgZnVuY3Rpb24gc2luaChuOiBudW1iZXIpOiBudW1iZXIge1xuXHRjb25zdCBtID0gTWF0aC5leHAobik7XG5cdHJldHVybiAobSAtIDEgLyBtKSAvIDI7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgaHlwZXJib2xpYyB0YW5nZW50IG9mIGEgbnVtYmVyLlxuICpcbiAqIEBwYXJhbSBuIFRoZSBudW1iZXIgdG8gdXNlIGluIGNhbGN1bGF0aW9uXG4gKiBAcmV0dXJuIFRoZSByZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRhbmgobjogbnVtYmVyKTogbnVtYmVyIHtcblx0aWYgKG4gPT09IEluZmluaXR5KSB7XG5cdFx0cmV0dXJuIDE7XG5cdH1cblx0ZWxzZSBpZiAobiA9PT0gLUluZmluaXR5KSB7XG5cdFx0cmV0dXJuIC0xO1xuXHR9XG5cdGVsc2Uge1xuXHRcdGNvbnN0IHkgPSBNYXRoLmV4cCgyICogbik7XG5cdFx0cmV0dXJuICh5IC0gMSkgLyAoeSArIDEpO1xuXHR9XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgaW50ZWdyYWwgcGFydCBvZiBhIG51bWJlciBieSByZW1vdmluZyBhbnkgZnJhY3Rpb25hbCBkaWdpdHMuXG4gKlxuICogQHBhcmFtIG4gVGhlIG51bWJlciB0byB1c2UgaW4gY2FsY3VsYXRpb25cbiAqIEByZXR1cm4gVGhlIHJlc3VsdFxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ1bmMobjogbnVtYmVyKTogbnVtYmVyIHtcblx0cmV0dXJuIG4gPCAwID8gTWF0aC5jZWlsKG4pIDogTWF0aC5mbG9vcihuKTtcbn1cbiJdfQ==