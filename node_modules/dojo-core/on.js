(function (factory) {
    if (typeof module === 'object' && typeof module.exports === 'object') {
        var v = factory(require, exports); if (v !== undefined) module.exports = v;
    }
    else if (typeof define === 'function' && define.amd) {
        define(["require", "exports", './lang'], factory);
    }
})(function (require, exports) {
    "use strict";
    var lang_1 = require('./lang');
    function emit(target, event) {
        if (target.dispatchEvent &&
            ((target.ownerDocument && target.ownerDocument.createEvent) ||
                (target.document && target.document.createEvent) ||
                target.createEvent) /* matches document */) {
            var nativeEvent = (target.ownerDocument || target.document || target).createEvent('HTMLEvents');
            nativeEvent.initEvent(event.type, Boolean(event.bubbles), Boolean(event.cancelable));
            for (var key in event) {
                if (!(key in nativeEvent)) {
                    nativeEvent[key] = event[key];
                }
            }
            return target.dispatchEvent(nativeEvent);
        }
        if (target.emit) {
            if (target.removeListener) {
                // Node.js EventEmitter
                target.emit(event.type, event);
                return false;
            }
            else if (target.on) {
                // Dojo Evented or similar
                target.emit(event);
                return false;
            }
        }
        throw new Error('Target must be an event emitter');
    }
    exports.emit = emit;
    function on(target, type, listener, capture) {
        if (Array.isArray(type)) {
            var handles = type.map(function (type) {
                return on(target, type, listener, capture);
            });
            return lang_1.createCompositeHandle.apply(void 0, handles);
        }
        var callback = function () {
            listener.apply(this, arguments);
        };
        // DOM EventTarget
        if (target.addEventListener && target.removeEventListener) {
            target.addEventListener(type, callback, capture);
            return lang_1.createHandle(function () {
                target.removeEventListener(type, callback, capture);
            });
        }
        if (target.on) {
            // EventEmitter
            if (target.removeListener) {
                target.on(type, callback);
                return lang_1.createHandle(function () {
                    target.removeListener(type, callback);
                });
            }
            else if (target.emit) {
                return target.on(type, listener);
            }
        }
        throw new TypeError('Unknown event emitter object');
    }
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.default = on;
    function once(target, type, listener, capture) {
        var handle = on(target, type, function () {
            handle.destroy();
            return listener.apply(this, arguments);
        }, capture);
        return handle;
    }
    exports.once = once;
    function pausable(target, type, listener, capture) {
        var paused;
        var handle = on(target, type, function () {
            if (!paused) {
                return listener.apply(this, arguments);
            }
        }, capture);
        handle.pause = function () {
            paused = true;
        };
        handle.resume = function () {
            paused = false;
        };
        return handle;
    }
    exports.pausable = pausable;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0lBQ0EscUJBQW9ELFFBQVEsQ0FBQyxDQUFBO0lBeUI3RCxjQUE0QyxNQUFXLEVBQUUsS0FBc0I7UUFDOUUsRUFBRSxDQUFDLENBQ0YsTUFBTSxDQUFDLGFBQWE7WUFDbkIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxhQUFhLElBQUksTUFBTSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUM7Z0JBQzNELENBQUMsTUFBTSxDQUFDLFFBQVEsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQztnQkFDaEQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLHNCQUN0QixDQUFDLENBQUMsQ0FBQztZQUNGLElBQU0sV0FBVyxHQUFHLENBQUMsTUFBTSxDQUFDLGFBQWEsSUFBSSxNQUFNLENBQUMsUUFBUSxJQUFJLE1BQU0sQ0FBQyxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUNsRyxXQUFXLENBQUMsU0FBUyxDQUNwQixLQUFLLENBQUMsSUFBSSxFQUNWLE9BQU8sQ0FBbUIsS0FBTSxDQUFDLE9BQU8sQ0FBQyxFQUN6QyxPQUFPLENBQW1CLEtBQU0sQ0FBQyxVQUFVLENBQUMsQ0FDNUMsQ0FBQztZQUVGLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBRyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQ3ZCLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUMzQixXQUFXLENBQUMsR0FBRyxDQUFDLEdBQVUsS0FBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUN2QyxDQUFDO1lBQ0YsQ0FBQztZQUVELE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQzFDLENBQUM7UUFFRCxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMs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O1FBRVosTUFBTSxDQUFDLE1BQU0sQ0FBQztJQUNmLENBQUM7SUFQZSxZQUFJLE9BT25CLENBQUE7SUFpQkQsa0JBQXlCLE1BQVcsRUFBRSxJQUFTLEVBQUUsUUFBYSxFQUFFLE9BQWlCO1FBQ2hGLElBQUksTUFBZSxDQUFDO1FBRXBCLElBQU0sTUFBTSxHQUFvQixFQUFFLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRTtZQUNoRCxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7Z0JBQ2IsTUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ3hDLENBQUM7UUFDRixDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFWixNQUFNLENBQUMsS0FBSyxHQUFHO1lBQ2QsTUFBTSxHQUFHLElBQUksQ0FBQztRQUNmLENBQUMsQ0FBQztRQUVGLE1BQU0sQ0FBQyxNQUFNLEdBQUc7WUFDZixNQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ2hCLENBQUMsQ0FBQztRQUVGLE1BQU0sQ0FBQyxNQUFNLENBQUM7SUFDZixDQUFDO0lBbEJlLGdCQUFRLFdBa0J2QixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSGFuZGxlLCBFdmVudE9iamVjdCB9IGZyb20gJy4vaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBjcmVhdGVIYW5kbGUsIGNyZWF0ZUNvbXBvc2l0ZUhhbmRsZSB9IGZyb20gJy4vbGFuZyc7XG5pbXBvcnQgRXZlbnRlZCBmcm9tICcuL0V2ZW50ZWQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEV2ZW50Q2FsbGJhY2sge1xuXHQoZXZlbnQ6IEV2ZW50T2JqZWN0KTogdm9pZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFdmVudEVtaXR0ZXIge1xuXHRvbihldmVudDogc3RyaW5nLCBsaXN0ZW5lcjogRXZlbnRDYWxsYmFjayk6IEV2ZW50RW1pdHRlcjtcblx0cmVtb3ZlTGlzdGVuZXIoZXZlbnQ6IHN0cmluZywgbGlzdGVuZXI6IEV2ZW50Q2FsbGJhY2spOiBFdmVudEVtaXR0ZXI7XG59XG5cbmludGVyZmFjZSBET01FdmVudE9iamVjdCBleHRlbmRzIEV2ZW50T2JqZWN0IHtcblx0YnViYmxlczogYm9vbGVhbjtcblx0Y2FuY2VsYWJsZTogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhIG5vcm1hbGl6ZWQgbWVjaGFuaXNtIGZvciBkaXNwYXRjaGluZyBldmVudHMgZm9yIGV2ZW50IGVtaXR0ZXJzLCBFdmVudGVkIG9iamVjdHMsIG9yIERPTSBub2Rlcy5cbiAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCB0byBlbWl0IHRoZSBldmVudCBmcm9tXG4gKiBAcGFyYW0gZXZlbnQgVGhlIGV2ZW50IG9iamVjdCB0byBlbWl0XG4gKiBAcmV0dXJuIEJvb2xlYW4gaW5kaWNhdGluZyBpZiBwcmV2ZW50RGVmYXVsdCB3YXMgY2FsbGVkIG9uIHRoZSBldmVudCBvYmplY3QgKG9ubHkgcmVsZXZhbnQgZm9yIERPTSBldmVudHM7XG4gKiAgICAgYWx3YXlzIGZhbHNlIGZvciBvdGhlciBldmVudCBlbWl0dGVycylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVtaXQ8VCBleHRlbmRzIEV2ZW50T2JqZWN0Pih0YXJnZXQ6IEV2ZW50ZWQgfCBFdmVudFRhcmdldCB8IEV2ZW50RW1pdHRlciwgZXZlbnQ6IFQgfCBFdmVudE9iamVjdCk6IGJvb2xlYW47XG5leHBvcnQgZnVuY3Rpb24gZW1pdDxUIGV4dGVuZHMgRXZlbnRPYmplY3Q+KHRhcmdldDogYW55LCBldmVudDogVCB8IEV2ZW50T2JqZWN0KTogYm9vbGVhbiB7XG5cdGlmIChcblx0XHR0YXJnZXQuZGlzcGF0Y2hFdmVudCAmJiAvKiBpbmNsdWRlcyB3aW5kb3cgYW5kIGRvY3VtZW50ICovXG5cdFx0XHQoKHRhcmdldC5vd25lckRvY3VtZW50ICYmIHRhcmdldC5vd25lckRvY3VtZW50LmNyZWF0ZUV2ZW50KSB8fCAvKiBtYXRjaGVzIG5vZGVzICovXG5cdFx0XHQodGFyZ2V0LmRvY3VtZW50ICYmIHRhcmdldC5kb2N1bWVudC5jcmVhdGVFdmVudCkgfHwgLyogbWF0Y2hlcyB3aW5kb3cgKi9cblx0XHRcdHRhcmdldC5jcmVhdGVFdmVudCkgLyogbWF0Y2hlcyBkb2N1bWVudCAqL1xuXHQpIHtcblx0XHRjb25zdCBuYXRpdmVFdmVudCA9ICh0YXJnZXQub3duZXJEb2N1bWVudCB8fCB0YXJnZXQuZG9jdW1lbnQgfHwgdGFyZ2V0KS5jcmVhdGVFdmVudCgnSFRNTEV2ZW50cycpO1xuXHRcdG5hdGl2ZUV2ZW50LmluaXRFdmVudChcblx0XHRcdGV2ZW50LnR5cGUsXG5cdFx0XHRCb29sZWFuKCg8RE9NRXZlbnRPYmplY3Q+IGV2ZW50KS5idWJibGVzKSxcblx0XHRcdEJvb2xlYW4oKDxET01FdmVudE9iamVjdD4gZXZlbnQpLmNhbmNlbGFibGUpXG5cdFx0KTtcblxuXHRcdGZvciAobGV0IGtleSBpbiBldmVudCkge1xuXHRcdFx0aWYgKCEoa2V5IGluIG5hdGl2ZUV2ZW50KSkge1xuXHRcdFx0XHRuYXRpdmVFdmVudFtrZXldID0gKDxhbnk+IGV2ZW50KVtrZXldO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0YXJnZXQuZGlzcGF0Y2hFdmVudChuYXRpdmVFdmVudCk7XG5cdH1cblxuXHRpZiAodGFyZ2V0LmVtaXQpIHtcblx0XHRpZiAodGFyZ2V0LnJlbW92ZUxpc3RlbmVyKSB7XG5cdFx0XHQvLyBOb2RlLmpzIEV2ZW50RW1pdHRlclxuXHRcdFx0dGFyZ2V0LmVtaXQoZXZlbnQudHlwZSwgZXZlbnQpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHRlbHNlIGlmICh0YXJnZXQub24pIHtcblx0XHRcdC8vIERvam8gRXZlbnRlZCBvciBzaW1pbGFyXG5cdFx0XHR0YXJnZXQuZW1pdChldmVudCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0dGhyb3cgbmV3IEVycm9yKCdUYXJnZXQgbXVzdCBiZSBhbiBldmVudCBlbWl0dGVyJyk7XG59XG5cbi8qKlxuICogUHJvdmlkZXMgYSBub3JtYWxpemVkIG1lY2hhbmlzbSBmb3IgbGlzdGVuaW5nIHRvIGV2ZW50cyBmcm9tIGV2ZW50IGVtaXR0ZXJzLCBFdmVudGVkIG9iamVjdHMsIG9yIERPTSBub2Rlcy5cbiAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IHRvIGxpc3RlbiBmb3IgZXZlbnQgb25cbiAqIEBwYXJhbSB0eXBlIEV2ZW50IGV2ZW50IHR5cGUocykgdG8gbGlzdGVuIGZvcjsgbWF5IGEgc3RyaW5nIG9yIGFuIGFycmF5IG9mIHN0cmluZ3NcbiAqIEBwYXJhbSBsaXN0ZW5lciBDYWxsYmFjayB0byBoYW5kbGUgdGhlIGV2ZW50IHdoZW4gaXQgZmlyZXNcbiAqIEBwYXJhbSBjYXB0dXJlIFdoZXRoZXIgdGhlIGxpc3RlbmVyIHNob3VsZCBiZSByZWdpc3RlcmVkIGluIHRoZSBjYXB0dXJlIHBoYXNlIChET00gZXZlbnRzIG9ubHkpXG4gKiBAcmV0dXJuIEEgaGFuZGxlIHdoaWNoIHdpbGwgcmVtb3ZlIHRoZSBsaXN0ZW5lciB3aGVuIGRlc3Ryb3kgaXMgY2FsbGVkXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG9uKHRhcmdldDogRXZlbnRUYXJnZXQsIHR5cGU6IHN0cmluZyB8IHN0cmluZ1tdLCBsaXN0ZW5lcjogRXZlbnRDYWxsYmFjaywgY2FwdHVyZT86IGJvb2xlYW4pOiBIYW5kbGU7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBvbih0YXJnZXQ6IEV2ZW50RW1pdHRlciB8IEV2ZW50ZWQsIHR5cGU6IHN0cmluZyB8IHN0cmluZ1tdLCBsaXN0ZW5lcjogRXZlbnRDYWxsYmFjayk6IEhhbmRsZTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG9uKHRhcmdldDogYW55LCB0eXBlOiBhbnksIGxpc3RlbmVyOiBhbnksIGNhcHR1cmU/OiBib29sZWFuKTogSGFuZGxlIHtcblx0aWYgKEFycmF5LmlzQXJyYXkodHlwZSkpIHtcblx0XHRsZXQgaGFuZGxlczogSGFuZGxlW10gPSB0eXBlLm1hcChmdW5jdGlvbiAodHlwZTogc3RyaW5nKTogSGFuZGxlIHtcblx0XHRcdHJldHVybiBvbih0YXJnZXQsIHR5cGUsIGxpc3RlbmVyLCBjYXB0dXJlKTtcblx0XHR9KTtcblxuXHRcdHJldHVybiBjcmVhdGVDb21wb3NpdGVIYW5kbGUoLi4uaGFuZGxlcyk7XG5cdH1cblxuXHRjb25zdCBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcblx0XHRsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9O1xuXG5cdC8vIERPTSBFdmVudFRhcmdldFxuXHRpZiAodGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIgJiYgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHtcblx0XHR0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBjYWxsYmFjaywgY2FwdHVyZSk7XG5cdFx0cmV0dXJuIGNyZWF0ZUhhbmRsZShmdW5jdGlvbiAoKSB7XG5cdFx0XHR0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBjYWxsYmFjaywgY2FwdHVyZSk7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAodGFyZ2V0Lm9uKSB7XG5cdFx0Ly8gRXZlbnRFbWl0dGVyXG5cdFx0aWYgKHRhcmdldC5yZW1vdmVMaXN0ZW5lcikge1xuXHRcdFx0dGFyZ2V0Lm9uKHR5cGUsIGNhbGxiYWNrKTtcblx0XHRcdHJldHVybiBjcmVhdGVIYW5kbGUoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHR0YXJnZXQucmVtb3ZlTGlzdGVuZXIodHlwZSwgY2FsbGJhY2spO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdC8vIEV2ZW50ZWRcblx0XHRlbHNlIGlmICh0YXJnZXQuZW1pdCkge1xuXHRcdFx0cmV0dXJuIHRhcmdldC5vbih0eXBlLCBsaXN0ZW5lcik7XG5cdFx0fVxuXHR9XG5cblx0dGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBldmVudCBlbWl0dGVyIG9iamVjdCcpO1xufVxuXG4vKipcbiAqIFByb3ZpZGVzIGEgbWVjaGFuaXNtIGZvciBsaXN0ZW5pbmcgdG8gdGhlIG5leHQgb2NjdXJyZW5jZSBvZiBhbiBldmVudCBmcm9tIGV2ZW50XG4gKiBlbWl0dGVycywgRXZlbnRlZCBvYmplY3RzLCBvciBET00gbm9kZXMuXG4gKiBAcGFyYW0gdGFyZ2V0IFRhcmdldCB0byBsaXN0ZW4gZm9yIGV2ZW50IG9uXG4gKiBAcGFyYW0gdHlwZSBFdmVudCBldmVudCB0eXBlKHMpIHRvIGxpc3RlbiBmb3I7IG1heSBiZSBhIHN0cmluZyBvciBhbiBhcnJheSBvZiBzdHJpbmdzXG4gKiBAcGFyYW0gbGlzdGVuZXIgQ2FsbGJhY2sgdG8gaGFuZGxlIHRoZSBldmVudCB3aGVuIGl0IGZpcmVzXG4gKiBAcGFyYW0gY2FwdHVyZSBXaGV0aGVyIHRoZSBsaXN0ZW5lciBzaG91bGQgYmUgcmVnaXN0ZXJlZCBpbiB0aGUgY2FwdHVyZSBwaGFzZSAoRE9NIGV2ZW50cyBvbmx5KVxuICogQHJldHVybiBBIGhhbmRsZSB3aGljaCB3aWxsIHJlbW92ZSB0aGUgbGlzdGVuZXIgd2hlbiBkZXN0cm95IGlzIGNhbGxlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gb25jZSh0YXJnZXQ6IEV2ZW50VGFyZ2V0LCB0eXBlOiBzdHJpbmcgfCBzdHJpbmdbXSwgbGlzdGVuZXI6IEV2ZW50Q2FsbGJhY2ssIGNhcHR1cmU/OiBib29sZWFuKTogSGFuZGxlO1xuZXhwb3J0IGZ1bmN0aW9uIG9uY2UodGFyZ2V0OiBFdmVudEVtaXR0ZXIgfCBFdmVudGVkLCB0eXBlOiBzdHJpbmcgfCBzdHJpbmdbXSwgbGlzdGVuZXI6IEV2ZW50Q2FsbGJhY2spOiBIYW5kbGU7XG5leHBvcnQgZnVuY3Rpb24gb25jZSh0YXJnZXQ6IGFueSwgdHlwZTogYW55LCBsaXN0ZW5lcjogYW55LCBjYXB0dXJlPzogYm9vbGVhbik6IEhhbmRsZSB7XG5cdGNvbnN0IGhhbmRsZSA9IG9uKHRhcmdldCwgdHlwZSwgZnVuY3Rpb24gKCkge1xuXHRcdGhhbmRsZS5kZXN0cm95KCk7XG5cdFx0cmV0dXJuIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sIGNhcHR1cmUpO1xuXG5cdHJldHVybiBoYW5kbGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGF1c2FibGVIYW5kbGUgZXh0ZW5kcyBIYW5kbGUge1xuXHRwYXVzZSgpOiB2b2lkO1xuXHRyZXN1bWUoKTogdm9pZDtcbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhIG1lY2hhbmlzbSBmb3IgY3JlYXRpbmcgcGF1c2FibGUgbGlzdGVuZXJzIGZvciBldmVudHMgZnJvbSBldmVudCBlbWl0dGVycywgRXZlbnRlZCBvYmplY3RzLCBvciBET00gbm9kZXMuXG4gKiBAcGFyYW0gdGFyZ2V0IFRhcmdldCB0byBsaXN0ZW4gZm9yIGV2ZW50IG9uXG4gKiBAcGFyYW0gdHlwZSBFdmVudCBldmVudCB0eXBlKHMpIHRvIGxpc3RlbiBmb3I7IG1heSBhIHN0cmluZyBvciBhbiBhcnJheSBvZiBzdHJpbmdzXG4gKiBAcGFyYW0gbGlzdGVuZXIgQ2FsbGJhY2sgdG8gaGFuZGxlIHRoZSBldmVudCB3aGVuIGl0IGZpcmVzXG4gKiBAcGFyYW0gY2FwdHVyZSBXaGV0aGVyIHRoZSBsaXN0ZW5lciBzaG91bGQgYmUgcmVnaXN0ZXJlZCBpbiB0aGUgY2FwdHVyZSBwaGFzZSAoRE9NIGV2ZW50cyBvbmx5KVxuICogQHJldHVybiBBIGhhbmRsZSB3aXRoIGFkZGl0aW9uYWwgcGF1c2UgYW5kIHJlc3VtZSBtZXRob2RzOyB0aGUgbGlzdGVuZXIgd2lsbCBuZXZlciBmaXJlIHdoZW4gcGF1c2VkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXVzYWJsZSh0YXJnZXQ6IEV2ZW50VGFyZ2V0LCB0eXBlOiBzdHJpbmcgfCBzdHJpbmdbXSwgbGlzdGVuZXI6IEV2ZW50Q2FsbGJhY2ssIGNhcHR1cmU/OiBib29sZWFuKTogUGF1c2FibGVIYW5kbGU7XG5leHBvcnQgZnVuY3Rpb24gcGF1c2FibGUodGFyZ2V0OiBFdmVudEVtaXR0ZXIgfCBFdmVudGVkLCB0eXBlOiBzdHJpbmcgfCBzdHJpbmdbXSwgbGlzdGVuZXI6IEV2ZW50Q2FsbGJhY2spOiBQYXVzYWJsZUhhbmRsZTtcbmV4cG9ydCBmdW5jdGlvbiBwYXVzYWJsZSh0YXJnZXQ6IGFueSwgdHlwZTogYW55LCBsaXN0ZW5lcjogYW55LCBjYXB0dXJlPzogYm9vbGVhbik6IFBhdXNhYmxlSGFuZGxlIHtcblx0bGV0IHBhdXNlZDogYm9vbGVhbjtcblxuXHRjb25zdCBoYW5kbGUgPSA8UGF1c2FibGVIYW5kbGU+IG9uKHRhcmdldCwgdHlwZSwgZnVuY3Rpb24gKCkge1xuXHRcdGlmICghcGF1c2VkKSB7XG5cdFx0XHRyZXR1cm4gbGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHR9XG5cdH0sIGNhcHR1cmUpO1xuXG5cdGhhbmRsZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRwYXVzZWQgPSB0cnVlO1xuXHR9O1xuXG5cdGhhbmRsZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG5cdFx0cGF1c2VkID0gZmFsc2U7XG5cdH07XG5cblx0cmV0dXJuIGhhbmRsZTtcbn1cbiJdfQ==